package exception;

import javax.swing.*;
import java.awt.*;
import java.util.ArrayList;
import gui.Main_GUI;

public class MenuBarPanel extends JPanel {

    private ArrayList<MenuButton> menuButtons = new ArrayList<>();
    private Main_GUI mainFrame;

    public MenuBarPanel(Main_GUI mainFrame) {
        this.mainFrame = mainFrame;

        setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));
        setBackground(new Color(36, 170, 140));
        setPreferredSize(new Dimension(270, 0));

        // ===== MENU =====

        MenuButton trangChu = createMenu("Trang ch·ªß");
        trangChu.addSubMenu("T·ªïng quan", "TrangChu");

        MenuButton sanPham = createMenu("S·∫£n ph·∫©m");
        sanPham.addSubMenu("Danh s√°ch", "DanhSachSanPham");
        sanPham.addSubMenu("Nh·∫≠p h√†ng", "NhapHang");

        MenuButton thongKe = createMenu("Th·ªëng k√™");
        thongKe.addSubMenu("Theo kh√°ch h√†ng", "TheoKhachHang");
        thongKe.addSubMenu("Theo ng√†y", "TheoNgay");

        addMenu(trangChu);
        addMenu(sanPham);
        addMenu(thongKe);

        add(Box.createVerticalGlue()); 
    }

    private MenuButton createMenu(String title) {
        MenuButton btn = new MenuButton(title, null);
        btn.setMenuActionListener(this::onMenuSelected);
        return btn;
    }

    private void addMenu(MenuButton btn) {
        menuButtons.add(btn);
        btn.setAlignmentX(Component.LEFT_ALIGNMENT);
        add(btn);
    }

    // üî• X·ª≠ l√Ω khi click submenu
    private void onMenuSelected(MenuButton source, String page) {

        // Collapse menu kh√°c v√† reset m√†u submenu
        for (MenuButton mb : menuButtons) {
            if (mb != source) {
                mb.collapse();
                mb.resetSubMenuColor();
            }
        }

        // Chuy·ªÉn trang
        if (page != null) {
            mainFrame.showPage(page);
        }
    }
}
